<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="../css/style.css">
  <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="../css/buttons.css">
</head>
<body>
  <div id="germline_pie" style="width: 840px; height: 350px; text-align: center; margin: auto"></div>
  <form style="text-align: center;">
    <label id='lblSelect'>
      <select id="selectPointOfInterest" style="margin: 0; padding: 1%" onchange="glmpieShow(this.options[this.options.selectedIndex].innerHTML);">
        <option>tian</option><option>tianshu</option><option>songshu</option><option>tianzi</option>
      </select>
    </label>&nbsp;&nbsp;
    <button type="button" id="pageUp" class="button button-normal button-border button-circle">
        <i class="icon-circle-arrow-up"></i>
    </button>
    <button type="button" id="pageDown" class="button button-normal button-border button-circle">
        <i class="icon-circle-arrow-down"></i>
    </button>
  </form>
  <script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="../js/echarts.min.js"></script>
  <script type="text/javascript" src="../js/macarons.js"></script>
  <script type="text/javascript">
    // change view function
    var glmpieShow = function(title1) {
      data_dict1 = {'tian': {'Het': 2001831, 'Hom': 1557166}, 'songshu': {'Het': 2080351, 'Hom': 1519200}, 'tianshu': {'Het': 2037596, 'Hom': 1546249}, 'tianzi': {'Het': 2086897, 'Hom': 1525888}};
      data_dict2 = {'tian': {'tv': 1161681, 'ts': 2397316}, 'songshu': {'tv': 1176343, 'ts': 2423208}, 'tianshu': {'tv': 1168716, 'ts': 2415129}, 'tianzi': {'tv': 1180304, 'ts': 2432481}};
      data_dict3 = {'tian': {'dbsnp': 3535613, 'novel': 23384}, 'songshu': {'dbsnp': 3575987, 'novel': 23564}, 'tianshu': {'dbsnp': 3560898, 'novel': 22947}, 'tianzi': {'dbsnp': 3589103, 'novel': 23682}};
      data_dict4 = {'tian': {'novel_ts': 14461, 'novel_tv': 8923}, 'songshu': {'novel_ts': 14454, 'novel_tv': 9110}, 'tianshu': {'novel_ts': 14125, 'novel_tv': 8822}, 'tianzi': {'novel_ts': 14506, 'novel_tv': 9176}};
      var classif = new Array();
      var data_if1 = new Array();
      var data_if2 = new Array();
      var data_if3 = new Array();
      var data_if4 = new Array();
      for (var key in data_dict1[title1]){
        classif.push(key);
        data_if1.push({"value": data_dict1[title1][key], "name": key});
      };
      for (var key in data_dict2[title1]){
        classif.push(key);
        data_if2.push({"value": data_dict2[title1][key], "name": key});
      };
      for (var key in data_dict3[title1]){
        classif.push(key);
        data_if3.push({"value": data_dict3[title1][key], "name": key});
      };
      for (var key in data_dict4[title1]){
        classif.push(key);
        data_if4.push({"value": data_dict4[title1][key], "name": key});
      };
      var myChart = echarts.init(document.getElementById('germline_pie'), 'macarons');
      var plot_option = {
        title : {
          text: title1,
          x:'center'
        },
        tooltip : {
          trigger: 'item',
          formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
          orient : 'vertical',
          x : 'left',
          data: classif,
          type : 'scroll'
        },
        toolbox: {
          show : true,
          x : '85%',
          feature : {
            mark : {show: true},
            dataView : {show: true, readOnly: false},
            magicType : {
              show: true,
              type: ['pie', 'funnel'],
              option: {
                funnel: {
                  x: '25%',
                  width: '50%',
                  funnelAlign: 'left',
                  max: 1548
                }
              }
            },
            restore : {show: true},
            saveAsImage : {show: true}
          }
        },
        calculable : true,
        series : [
          {
            name:'SNP纯杂合比例',
            type:'pie',
            radius : '40%',
            center: ['33%', '25%'],
            data: data_if1
          },
          {
            name:'SNP转换颠换比例',
            type:'pie',
            radius : '40%',
            center: ['70%', '25%'],
            data: data_if2
          },
          {
            name:'SNP新SNP与dbsnp中已收录占比',
            type:'pie',
            radius : '40%',
            center: ['33%', '75%'],
            data: data_if3
          },
          {
            name:'novel SNP转换颠换比例',
            type:'pie',
            radius : '40%',
            center: ['70%', '75%'],
            data: data_if4
          }
        ]
      };
      myChart.setOption(plot_option);
    };
    glmpieShow('tian');
    $(function() {
      $("#pageUp").click(function(){
        let downNode = this.nextElementSibling;
        let selectNode = this.parentNode.firstElementChild.firstElementChild;
        if (selectNode.selectedIndex == 0){
          this.style.visibility = 'hidden';
        }else{
          selectNode.selectedIndex = selectNode.selectedIndex - 1;
          glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
          downNode.style.visibility = 'visible';
        };
      });
      $("#pageDown").click(function(){
        let upNode = this.previousElementSibling;
        let selectNode = this.parentNode.firstElementChild.firstElementChild;
        if ( selectNode.selectedIndex == selectNode.options.length - 1){
          this.style.visibility = 'hidden';
        }else{
          selectNode.selectedIndex = selectNode.selectedIndex + 1;
          glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
          upNode.style.visibility = 'visible';
        }
      });
      $("#selectPointOfInterest").change(function(){
        let upNode = this.parentNode.nextElementSibling;
        let downNode = upNode.nextElementSibling;
        upNode.style.visibility = 'visible';
        downNode.style.visibility = 'visible';
      });
    });
  </script>
</body>
</html>