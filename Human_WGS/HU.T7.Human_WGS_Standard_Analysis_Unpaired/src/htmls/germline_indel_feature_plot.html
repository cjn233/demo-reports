<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="../css/style.css">
  <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="../css/buttons.css">
</head>
<body>
  <div id="germline_pie" style="width: 840px; height: 350px; text-align: center; margin: auto"></div>
  <form style="text-align: center;">
    <label id='lblSelect'>
      <select id="selectPointOfInterest" style="margin: 0; padding: 1%" onchange="glmpieShow(this.options[this.options.selectedIndex].innerHTML);">
        <option>tian</option>
        <option>tianshu</option>
        <option>songshu</option>
        <option>tianzi</option>
        
      </select>
    </label>&nbsp;&nbsp;
    <button type="button" id="pageUp" class="button button-normal button-border button-circle">
        <i class="icon-circle-arrow-up"></i>
    </button>
    <button type="button" id="pageDown" class="button button-normal button-border button-circle">
        <i class="icon-circle-arrow-down"></i>
    </button>
  </form>
  <script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="../js/echarts.min.js"></script>
  <script type="text/javascript" src="../js/macarons.js"></script>
  <script type="text/javascript">
    // change view function
    var glmpieShow = function(title1) {
      data_dict1 = {'tian': {'Het': 773801, 'Hom': 238470}, 'songshu': {'Het': 799203, 'Hom': 233295}, 'tianshu': {'Het': 787282, 'Hom': 238261}, 'tianzi': {'Het': 768613, 'Hom': 242567}};
      data_dict2 = {'tian': {'dbsnp': 802503, 'novel': 209768}, 'songshu': {'dbsnp': 817455, 'novel': 215043}, 'tianshu': {'dbsnp': 811982, 'novel': 213561}, 'tianzi': {'dbsnp': 814519, 'novel': 196661}};
      var classif = new Array();
      var data_if1 = new Array();
      var data_if2 = new Array();
      for (var key in data_dict1[title1]){
        classif.push(key);
        data_if1.push({"value": data_dict1[title1][key], "name": key});
      };
      for (var key in data_dict2[title1]){
        classif.push(key);
        data_if2.push({"value": data_dict2[title1][key], "name": key});
      };
      var myChart = echarts.init(document.getElementById('germline_pie'), 'macarons');
      var plot_option = {
        title : {
          text: title1,
          x:'center'
        },
        tooltip : {
          trigger: 'item',
          formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        legend: {
          orient : 'vertical',
          x : 'left',
          data: classif,
          type : 'scroll'
        },
        toolbox: {
          show : true,
          x : '85%',
          feature : {
            mark : {show: true},
            dataView : {show: true, readOnly: false},
            magicType : {
              show: true,
              type: ['pie', 'funnel'],
              option: {
                funnel: {
                  x: '25%',
                  width: '50%',
                  funnelAlign: 'left',
                  max: 1548
                }
              }
            },
            restore : {show: true},
            saveAsImage : {show: true}
          }
        },
        calculable : true,
        series : [
          {
            name:'InDel纯杂合比例',
            type:'pie',
            radius : '50%',
            center: ['25%', '50%'],
            data: data_if1
          },
          {
            name:'InDel新SNP与dbsnp中已收录占比',
            type:'pie',
            radius : '50%',
            center: ['75%', '50%'],
            data: data_if2
          }
        ]
      };
      myChart.setOption(plot_option);
    };
    glmpieShow('tian');
    $(function() {
      $("#pageUp").click(function(){
        let downNode = this.nextElementSibling;
        let selectNode = this.parentNode.firstElementChild.firstElementChild;
        if (selectNode.selectedIndex == 0){
          this.style.visibility = 'hidden';
        }else{
          selectNode.selectedIndex = selectNode.selectedIndex - 1;
          glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
          downNode.style.visibility = 'visible';
        };
      });
      $("#pageDown").click(function(){
        let upNode = this.previousElementSibling;
        let selectNode = this.parentNode.firstElementChild.firstElementChild;
        if ( selectNode.selectedIndex == selectNode.options.length - 1){
          this.style.visibility = 'hidden';
        }else{
          selectNode.selectedIndex = selectNode.selectedIndex + 1;
          glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
          upNode.style.visibility = 'visible';
        }
      });
      $("#selectPointOfInterest").change(function(){
        let upNode = this.parentNode.nextElementSibling;
        let downNode = upNode.nextElementSibling;
        upNode.style.visibility = 'visible';
        downNode.style.visibility = 'visible';
      });
    });
  </script>
</body>
</html>