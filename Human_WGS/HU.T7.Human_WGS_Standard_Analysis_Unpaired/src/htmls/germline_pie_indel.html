<!DOCTYPE html>
<html>
<head>
    <title>raw data pie</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="../css/style.css">
        <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="../css/buttons.css">
</head>
<body>
    <div id="germline_pie" style="width: 840px; height: 350px; text-align: center; margin: auto"></div>
    <form style="text-align: center;">
        <label id='lblSelect'>
        <select id="selectPointOfInterest" style="margin: 0; padding: 1%" onchange="glmpieShow(this.options[this.options.selectedIndex].innerHTML);">
            <option>tian</option>
				<option>songshu</option>
				<option>tianshu</option>
				<option>tianzi</option>
        </select>
        </label>&nbsp;&nbsp;
        <button type="button" id="pageUp" class="button button-normal button-border button-circle">
            <i class="icon-circle-arrow-up"></i>
        </button>
        <button type="button" id="pageDown" class="button button-normal button-border button-circle">
            <i class="icon-circle-arrow-down"></i>
        </button>
    </form>
        <script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="../js/echarts.min.js"></script>
    <script type="text/javascript" src="../js/macarons.js"></script>
    <script type="text/javascript">
        // change view function
        var glmpieShow = function(title1) {
            data_dict = {'tian': {'splicing': 398, 'downstream': 8157, 'UTR5': 1093, 'ncRNA_exonic': 2359, 'intergenic': 516039, 'ncRNA_UTR5': 2, 'intronic': 400911, 'ncRNA_UTR3': 0, 'UTR3': 11109, 'startloss': 2, 'ncRNA_splicing': 104, 'CDS': 596, 'upstream': 6848, 'ncRNA_intronic': 64927}, 'songshu': {'splicing': 393, 'downstream': 8314, 'UTR5': 1134, 'ncRNA_exonic': 2344, 'intergenic': 527156, 'ncRNA_UTR5': 2, 'intronic': 407998, 'ncRNA_UTR3': 0, 'UTR3': 11191, 'startloss': 3, 'ncRNA_splicing': 97, 'CDS': 612, 'upstream': 7067, 'ncRNA_intronic': 66501}, 'tianshu': {'splicing': 431, 'downstream': 8333, 'UTR5': 1143, 'ncRNA_exonic': 2353, 'intergenic': 520721, 'ncRNA_UTR5': 2, 'intronic': 407920, 'ncRNA_UTR3': 0, 'UTR3': 11256, 'startloss': 3, 'ncRNA_splicing': 97, 'CDS': 593, 'upstream': 7025, 'ncRNA_intronic': 65963}, 'tianzi': {'splicing': 383, 'downstream': 8278, 'UTR5': 1161, 'ncRNA_exonic': 2315, 'intergenic': 517278, 'ncRNA_UTR5': 2, 'intronic': 398122, 'ncRNA_UTR3': 0, 'UTR3': 11082, 'startloss': 2, 'ncRNA_splicing': 98, 'CDS': 592, 'upstream': 7007, 'ncRNA_intronic': 65160}};
            data_dict1 = {'tian': {'stoploss': 2, 'frameshift insertion': 60, 'unknown': 100, 'nonframeshift insertion': 169, 'frameshift deletion': 61, 'stopgain': 7, 'nonframeshift deletion': 195}, 'songshu': {'stoploss': 2, 'frameshift insertion': 56, 'unknown': 100, 'nonframeshift insertion': 164, 'frameshift deletion': 72, 'stopgain': 12, 'nonframeshift deletion': 203}, 'tianshu': {'stoploss': 1, 'frameshift insertion': 61, 'unknown': 97, 'nonframeshift insertion': 159, 'frameshift deletion': 63, 'stopgain': 10, 'nonframeshift deletion': 199}, 'tianzi': {'stoploss': 1, 'frameshift insertion': 51, 'unknown': 104, 'nonframeshift insertion': 178, 'frameshift deletion': 57, 'stopgain': 9, 'nonframeshift deletion': 190}};
            var classif = new Array();
            var data_if = new Array();
            var data_if2 = new Array();
            for (var key in data_dict[title1]){
                classif.push(key);
                data_if.push({"value": data_dict[title1][key], "name": key});
            };
            for (var key in data_dict1[title1]){
                classif.push(key);
                data_if2.push({"value": data_dict1[title1][key], "name": key});
            };
            var myChart = echarts.init(document.getElementById('germline_pie'), 'macarons');
            var plot_option = {
                title : {
                    text: title1,
                    x:'center'
                },
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                legend: {
                    orient : 'vertical',
                    x : 'left',
                    data: classif,
                    type : 'scroll'
                },
                toolbox: {
                    show : true,
                    x : 700,
                    feature : {
                        mark : {show: true},
                        dataView : {show: true, readOnly: false},
                        magicType : {
                            show: true,
                            type: ['pie', 'funnel'],
                            option: {
                                funnel: {
                                    x: '25%',
                                    width: '50%',
                                    funnelAlign: 'left',
                                    max: 1548
                                }
                            }
                        },
                        restore : {show: true},
                        saveAsImage : {show: true}
                    }
                },
                calculable : true,
                series : [
                    {
                        name:'基因组不同区域上INDEL数目',
                        type:'pie',
                        radius : '50%',
                        center: ['40%', '55%'],
                        data: data_if
                    },
                    {
                        name:'编码区不同类型INDEL数目',
                        type:'pie',
                        radius : '20%',
                        center: ['80%', '65%'],
                        data: data_if2
                    }
                ]
            };
            myChart.setOption(plot_option);
        };
        glmpieShow("tian");
        $(function() {
            $("#pageUp").click(function(){
                let downNode = this.nextElementSibling;
                let selectNode = this.parentNode.firstElementChild.firstElementChild;
                if (selectNode.selectedIndex == 0){
                    this.style.visibility = 'hidden';
                }else{
                    selectNode.selectedIndex = selectNode.selectedIndex - 1;
                    glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
                    downNode.style.visibility = 'visible';
                };
            });
            $("#pageDown").click(function(){
                let upNode = this.previousElementSibling;
                let selectNode = this.parentNode.firstElementChild.firstElementChild;
                if ( selectNode.selectedIndex == selectNode.options.length - 1){
                    this.style.visibility = 'hidden';
                }else{
                    selectNode.selectedIndex = selectNode.selectedIndex + 1;
                    glmpieShow(selectNode.options[selectNode.selectedIndex].innerHTML);
                    upNode.style.visibility = 'visible';
                }
            });
                        $("#selectPointOfInterest").change(function(){
                            let upNode = this.parentNode.nextElementSibling;
                            let downNode = upNode.nextElementSibling;
                            upNode.style.visibility = 'visible';
                            downNode.style.visibility = 'visible';
                        });
        });
    </script>
</body>
</html>
